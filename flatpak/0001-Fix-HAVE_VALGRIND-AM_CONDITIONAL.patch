From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: OmniGet <noreply@tonho.wtf>
Subject: [PATCH] Fix HAVE_VALGRIND AM_CONDITIONAL not defined when tests
 disabled

Move AM_CONDITIONAL(HAVE_VALGRIND, ...) outside the tests-only AS_IF
block so it is always defined, even with --disable-tests.

diff --git a/configure.ac b/configure.ac
--- a/configure.ac
+++ b/configure.ac
@@ -112,10 +112,11 @@
 AS_IF([test "x$enable_tests" != "xno"],[
 PKG_CHECK_MODULES(DBUSMENUTESTS,  json-glib-1.0 >= $JSON_GLIB_REQUIRED_VERSION
                                   gio-unix-2.0  >= $GIO_UNIX_REQUIRED_VERSION,
                                   [have_tests=yes]
 )
 PKG_CHECK_MODULES(DBUSMENUTESTSVALGRIND, valgrind, have_valgrind=yes, have_valgrind=no)
-AM_CONDITIONAL([HAVE_VALGRIND], [test "x$have_valgrind" = "xyes"])
 ])

+AM_CONDITIONAL([HAVE_VALGRIND], [test "x$have_valgrind" = "xyes"])
+
 AC_SUBST(DBUSMENUTESTS_CFLAGS)
 AC_SUBST(DBUSMENUTESTS_LIBS)
